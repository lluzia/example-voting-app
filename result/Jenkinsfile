pipeline {
    agent {
        docker: { image 'node:8.18.0-alpine'}
    }
    

    stages {
      
        stage('build') {
            when{
                changeset "**/result/**"
            }
            steps {
                echo 'Compiling result app'
                dir('result'){
                    sh 'npm install'
                }
            }
        }
        
        stage('test') {
            when{
                changeset "**/result/**"
                
            }
            steps {
                echo 'Running Unit Tests on result app'
                dir('result'){
                    sh 'npm install'
                    sh 'npm test'
                }
                
            }
        }
        // stage('package') {
        //     when{
        //         branch 'master'
        //         changeset "**/result/**"
        //     }
        //     steps {
        //         echo 'Packaging result app'
        //         dir('result'){
        //             sh 'mvn package -DskipTests'
        //             archiveArtifacts artifacts: '**/target/*.jar', fingerprint: true
        //         }
                
        //     }
        // }
      }
        
    post{
      always{
        
        echo 'Job completed.'
      }
    }
}
